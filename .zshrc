export ZSH=/Users/kyoko/.oh-my-zsh

ZSH_THEME="cute-theme"

source $ZSH/oh-my-zsh.sh

BULLETTRAIN_PROMPT_CHAR="ðŸ¹ "

source ~/.zplug/init.zsh
zplug 'zsh-users/zsh-completions'
zplug 'zsh-users/zaw'
zplug 'zsh-users/zsh-syntax-highlighting', defer:2
zplug check || zplug install


autoload -Uz chpwd_recent_dirs cdr add-zsh-hook is-at-least
if is-at-least 4.3.10; then
add-zsh-hook chpwd chpwd_recent_dirs
zstyle ':chpwd:*' recent-dirs-max 5000
zstyle ':chpwd:*' recent-dirs-default yes
fi

zplug load

HISTFILE=~/.zsh_historyx
HISTSIZE=10000
SAVEHIST=10000

setopt no_beep  # è£œå®Œå€™è£œãŒãªã„ã¨ããªã©ã«ãƒ“ãƒ¼ãƒ—éŸ³ã‚’é³´ã‚‰ã•ãªã„ã€‚
setopt transient_rprompt  # ã‚³ãƒžãƒ³ãƒ‰å®Ÿè¡Œå¾Œã¯å³ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ¶ˆã™
setopt hist_ignore_dups   # ç›´å‰ã¨åŒã˜ã‚³ãƒžãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ãƒ’ã‚¹ãƒˆãƒªã«è¿½åŠ ã—ãªã„
setopt hist_ignore_all_dups  # é‡è¤‡ã—ãŸãƒ’ã‚¹ãƒˆãƒªã¯è¿½åŠ ã—ãªã„
setopt hist_reduce_blanks
setopt hist_no_store
setopt hist_verify
setopt share_history  # ã‚·ã‚§ãƒ«ã®ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã«å±¥æ­´ã‚’å…±æœ‰
setopt extended_history  # å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã«æ™‚åˆ»ã‚’è¨˜éŒ²
setopt append_history  # è¤‡æ•°ã® zsh ã‚’åŒæ™‚ã«ä½¿ã†æ™‚ãªã© history ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¸Šæ›¸ãã›ãšè¿½åŠ 
setopt auto_cd  # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã ã‘ã§ç§»å‹•
setopt auto_pushd  # cd ã—ãŸã‚‰ pushd
setopt auto_list  # è£œå®Œå€™è£œãŒè¤‡æ•°ã‚ã‚‹æ™‚ã«ã€ä¸€è¦§è¡¨ç¤º
setopt auto_menu  # è£œå®Œå€™è£œãŒè¤‡æ•°ã‚ã‚‹ã¨ãã«è‡ªå‹•çš„ã«ä¸€è¦§è¡¨ç¤ºã™ã‚‹
setopt list_packed
setopt list_types
setopt no_flow_control
setopt print_eight_bit
setopt pushd_ignore_dups
setopt rec_exact
setopt autoremoveslash
unsetopt list_beep
setopt complete_in_word  # ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§è£œå®Œã™ã‚‹ã€‚
setopt glob
setopt glob_complete  # globã‚’å±•é–‹ã—ãªã„ã§å€™è£œã®ä¸€è¦§ã‹ã‚‰è£œå®Œã™ã‚‹ã€‚
setopt extended_glob  # æ‹¡å¼µglobã‚’æœ‰åŠ¹ã«ã™ã‚‹ã€‚
setopt mark_dirs   # globã§ãƒ‘ã‚¹ã‚’ç”Ÿæˆã—ãŸã¨ãã«ã€ãƒ‘ã‚¹ãŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã ã£ãŸã‚‰æœ€å¾Œã«ã€Œ/ã€ã‚’ã¤ã‘ã‚‹ã€‚


function zaw-src-gitdir () {
    _dir=$(git rev-parse --show-cdup 2>/dev/null)
    if [ $? -eq 0 ]
    then
        candidates=( $(git ls-files ${_dir} | perl -MFile::Basename -nle \
                                                   '$a{dirname $_}++; END{delete $a{"."}; print for sort keys %a}') )
    fi

    actions=("zaw-src-gitdir-cd")
    act_descriptions=("change directory in git repos")
}

function zaw-src-gitdir-cd () {
    BUFFER="cd $1"
    zle accept-line
}

zaw-register-src -n gitdir zaw-src-gitdir
